"use strict";(self.webpackChunkangular_canvas_2=self.webpackChunkangular_canvas_2||[]).push([[686],{6686:(te,N,u)=>{u.r(N),u.d(N,{CanvasModule:()=>ee});var R=u(6895),S=u(4006),d=u(7615),w=u(9886),e=u(4650),v=u(727),C=u(4968),a=(()=>{return(o=a||(a={})).RECTANGLE="RECTANGLE",o.ELLIPSE="ELLIPSE",o.LINE="LINE",o.TRIANGLE="TRIANGLE",o.TEXT="TEXT",o.IMAGE="IMAGE",o.HAND="HAND",a;var o})();function T(o,s){try{const t=Object.keys(o),n=Object.keys(s);if(t.length!==n.length)return!1;for(const i of t){const r=o[i],_=s[i],l=b(r)&&b(_);if(l&&!T(r,_)||!l&&r!==_)return!1}return!0}catch(t){return t instanceof TypeError}}function b(o){return null!=o&&"object"==typeof o}class L{constructor(s){this._name=s.name||this.constructor.name+"-"+Date.now(),this.toString=()=>this._name,this._strokeStyle=s.strokeStyle||"black",this._x=s.x||0,this._y=s.y||0,this._selected=!1}get isSelected(){return this._selected}get name(){return this._name}get strokeStyle(){return this._strokeStyle}set strokeStyle(s){this._strokeStyle=s}get coords(){return{x:this._x,y:this._y}}set coords({x:s,y:t}){this._x=s,this._y=t}setParams(s){this._name=s.name??this._name,this._x=s.x??this._x,this._y=s.y??this._y,this._strokeStyle=s.strokeStyle??this._strokeStyle}select(){this._selected=!0}deselect(){this._selected=!1}}class k extends L{constructor(s){super(s),this._path=new Path2D}get path(){return new Path2D(this._path)}draw(s){this.makePath(),s.save(),s.strokeStyle=this._strokeStyle,s.stroke(this._path),this._selected&&(s.strokeStyle="blue",s.lineWidth=4,s.setLineDash([8,15]),s.stroke(this._path),s.setLineDash([])),s.restore()}drawTry(s){this.makePath(),s.save(),s.strokeStyle="blue",s.stroke(this._path),s.restore()}drawHover(s){s.save(),s.strokeStyle="blue",s.lineWidth=3,s.stroke(this.path),s.restore()}}class I extends k{constructor(s){super(s),this._height=s.h||50,this._width=s.w||50,this._rotation=s.r||0}get height(){return this._height}set height(s){this._height=s}get width(){return this._width}set width(s){this._width=s}get rotationDegrees(){return 180*this._rotation/Math.PI}set rotationDegrees(s){this._rotation=s*Math.PI/180}get rotation(){return this._rotation}set rotation(s){this._rotation=s}draw(s){s.save(),s.strokeStyle=this._strokeStyle,s.stroke(this._path),super.draw(s),s.restore()}drawTry(s){s.save(),s.strokeStyle="blue",s.stroke(this._path),s.restore()}setParams(s){this._height=s.h??this._height,this._width=s.w??this._width,this._rotation=s.r??this._rotation,super.setParams(s)}}class P extends I{constructor(s){super(s),this._fillStyle=s.fillStyle||"black"}get fillStyle(){return this._fillStyle}set fillStyle(s){this._fillStyle=s}draw(s){this.makePath(),s.save(),s.fillStyle=this._fillStyle,s.strokeStyle=this._strokeStyle,s.fill(this._path),super.draw(s),s.restore()}drawTry(s){this.makePath(),s.save(),s.fillStyle="",s.strokeStyle="blue",s.stroke(this._path),s.restore()}setParams(s){this._fillStyle=s.fillStyle??this._fillStyle,super.setParams(s)}}class M extends P{get params(){return{name:this._name,x:this._x,y:this._y,value:"",src:"",strokeStyle:this._strokeStyle,fillStyle:this._fillStyle,w:this._width,h:this._height,r:0,x2:null,y2:null,fontSize:null}}constructor(s){super(s)}makePath(){this._path=new Path2D,this._path=new Path2D,this._path.rect(this._x,this._y,this._width,this._height)}draw(s){this.makePath(),super.draw(s)}drawTry(s){this.makePath(),super.drawTry(s)}}class y extends P{get params(){return{name:this._name,x:this._x,y:this._y,value:"",src:"",strokeStyle:this._strokeStyle,fillStyle:this._fillStyle,w:this._width,h:this._height,r:this._rotation,x2:null,y2:null,fontSize:null}}constructor(s){super(s),this._rotation=s.r||Math.PI}makePath(){const s=this._x+Math.ceil(this._width/2),t=this._y+Math.ceil(this._height/2),n=Math.ceil(this._width/2),i=Math.ceil(this._height/2);this._path=new Path2D,this._path.ellipse(s,t,n,i,this._rotation,0,2*Math.PI)}}class f extends k{constructor(s){super(s),this._x=s.x||0,this._y=s.y||0,this._x2=s.x2||this._x+50,this._y2=s.y2||this._y+50}get params(){return{name:this._name,x:this._x,y:this._y,value:"",src:"",strokeStyle:this._strokeStyle,fillStyle:"",w:this._x2-this._x,h:this._y2-this._y,r:null,x2:this._x2,y2:this._y2,fontSize:null}}get coords(){return{x:this._x,y:this._y}}set coords({x:s,y:t}){this._x=s,this._y=t}get fullCoords(){return{x1:this._x,y1:this._y,x2:this._x2,y2:this._y2}}set fullCoords({x1:s,y1:t,x2:n,y2:i}){this._x=s,this._y=t,this._x2=n,this._y2=i}makePath(){this._path=new Path2D,this._path.moveTo(this._x,this._y),this._path.lineTo(this._x2,this._y2)}draw(s){this.makePath(),s.save(),s.strokeStyle=this._strokeStyle,s.stroke(this._path),this._selected&&(s.strokeStyle="blue",s.lineWidth=4,s.setLineDash([8,15]),s.stroke(this._path),s.setLineDash([])),s.restore()}drawTry(s){this.makePath(),s.save(),s.strokeStyle="blue",s.stroke(this._path),s.restore()}setParams(s){this._x2=s.x2??this._x2,this._y2=s.y2??this._y2,super.setParams(s)}}class x extends P{get params(){return{name:this._name,x:this._x,y:this._y,value:"",src:"",strokeStyle:this._strokeStyle,fillStyle:this._fillStyle,w:this._width,h:this._height,x2:null,y2:null,r:this._rotation,fontSize:null}}constructor(s){super(s)}makePath(){this._path=new Path2D,this._path.moveTo(this._x+Math.ceil(this._width/2),this._y),this._path.lineTo(this._x,this._y+this._height),this._path.lineTo(this._x+this._width,this._y+this._height),this._path.closePath()}}class m extends L{constructor(s){super(s),this._fontSize=s.fontSize||30,this._value=s.value}get params(){return{name:this._name,x:this._x,y:this._y,value:this._value,src:"",strokeStyle:this._strokeStyle,fontSize:this._fontSize,x2:null,y2:null,h:this._fontSize,w:null,r:null,fillStyle:null}}set fontSize(s){this._fontSize=s}get fontSize(){return this._fontSize}set value(s){this._value=s}get value(){return this._value}draw(s){s.save(),s.font=`${this._fontSize}px serif`,s.strokeStyle=this.strokeStyle,s.fillStyle=this.strokeStyle,s.fillText(this._value,this._x,this._y),s.strokeText(this._value,this._x,this._y),this._selected&&(s.strokeStyle="blue",s.lineWidth=4,s.setLineDash([6,3]),s.strokeText(this._value,this._x,this._y)),s.restore()}drawTry(s){s.save(),s.font=`${this._fontSize}px serif`,s.fillStyle="blue",s.fillText(this._value,this._x,this._y),s.restore()}drawHover(s){s.save(),s.font=`${this._fontSize}px serif`,s.strokeStyle="blue",s.lineWidth=3,s.strokeText(this._value,this._x,this._y),s.restore()}setParams(s){this._value=s.value??this._value,this._fontSize=s.fontSize??this._fontSize,super.setParams(s)}}var A=u(7579);class E extends I{constructor(s){super(s),this._img=new Image,this._isLoaded=!1,this._whenLoaded$=new A.x,this._imgSrc=s.src,this._height=s.h||0,this._width=s.w||0}get params(){return{name:this._name,x:this._x,y:this._y,value:"",src:this._imgSrc,strokeStyle:this._strokeStyle,w:this._width,h:this._height,x2:null,y2:null,fontSize:null,fillStyle:null,r:this._rotation}}get whenLoaded(){return this._whenLoaded$.asObservable()}get img(){return this._img}set imgSrc(s){this._imgSrc=s,this._img.src=this._imgSrc}makePath(){this._path=new Path2D,0===this._height&&0===this._width&&(this._height=this._img.height,this._width=this._img.width),this._path.rect(this._x,this._y,this._width,this._height)}drawTry(s){this.makePath(),super.drawTry(s)}draw(s){if(this._img.src=this._imgSrc,this._isLoaded)this.makePath(),s.drawImage(this._img,this._x,this._y,this._width,this._height);else{const t=(0,C.R)(this._img,"load").subscribe(()=>{this.makePath(),s.drawImage(this._img,this._x,this._y,this._width,this._height),this._isLoaded=!0,this._whenLoaded$.next(!0),t.unsubscribe()})}this._strokeStyle="",super.draw(s)}setParams(s){this._imgSrc=s.src??this._imgSrc,super.setParams(s)}}class ${static createElement(s=a.RECTANGLE,t={x:0,y:0,h:100,w:100,x2:100,y2:100,src:""}){switch(s){case a.RECTANGLE:return new M(t);case a.ELLIPSE:return t.w<0&&(t.x=t.x+t.w,t.w=Math.abs(t.w)),t.h<0&&(t.y=t.y+t.h,t.h=Math.abs(t.h)),new y(t);case a.LINE:return new f(t);case a.TRIANGLE:return new x(t);case a.TEXT:return new m(t);case a.IMAGE:if(""===t.src)throw new Error("No image selected");return new E(t);default:return new M(t)}}}let g=(()=>{class o{constructor(){this._elements=[],this._lockCanvas=!1}get canvas(){return this._canvas}disableClick(){this._lockCanvas=!0}enableClick(){this._lockCanvas=!1}get lockCanvas(){return this._lockCanvas}get elements(){return this._elements}get lastElement(){return this._elements.at(this._elements.length-1)}get context(){return this._ctx}init(t,n=[]){if(!(t instanceof HTMLCanvasElement))throw TypeError("\u0415\u043B\u0435\u043C\u0435\u043D\u0442 \u043A\u0430\u043D\u0432\u0430\u0441\u0443 \u043F\u043E\u0432\u0438\u043D\u0435\u043D \u0431\u0443\u0442\u0438 \u0432\u0430\u043B\u0456\u0434\u043D\u0438\u043C");{let i;if(this._canvas=t,this._canvas.height=this._canvas.clientHeight,this._canvas.width=this._canvas.clientWidth,!(i=t.getContext("2d")))throw TypeError("\u0411\u0443\u0434\u044C\u043B\u0430\u0441\u043A\u0430 \u043D\u0430\u0434\u0430\u0439\u0442\u0435 \u043E\u0431'\u0454\u043A\u0442 \u043A\u0430\u043D\u0432\u0430\u0441\u0443");this._ctx=i,this._elements=this._elements.concat(n),this.render()}}uninit(){this._canvas=void 0}get isInitialized(){return!!this._canvas}drawPreviw(t){this.render(),t.drawTry(this._ctx)}renderPreviw(t,n){const i=$.createElement(t,n);i&&this.drawPreviw(i)}addElement(t){this._elements.push(t),this.render()}removeElem(t){this._elements=this._elements.filter(n=>n.name!=t)}clear(){this._canvas&&(this._ctx.clearRect(0,0,this._canvas.clientWidth,this._canvas.clientHeight),this._elements=[])}render(){if(this._canvas){this._ctx.clearRect(0,0,this._canvas.clientWidth,this._canvas.clientHeight);for(const t of this._elements)t.draw(this._ctx)}}}return o.\u0275fac=function(t){return new(t||o)},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})(),O=(()=>{class o{constructor(t){this._canvasService=t,this._selection=a.HAND,this.params={x:100,y:100,strokeStyle:"#000000",name:"Shape-1",h:100,w:100,fillStyle:"#FF0000",r:0,x2:200,y2:200,value:"Hello world!",fontSize:14,src:""},this._paramsType="fillParams",this._paramsTypeSubject$=new A.x,this._selectionChange$=new A.x}get paramsType(){return this._paramsTypeSubject$.asObservable()}get selectionChange(){return this._selectionChange$.asObservable()}get selection(){return this._selection}getParamsType(){return this.selection==a.LINE?"lineParams":this.selection==a.IMAGE?"imageParams":this.selection==a.TEXT?"textParams":"fillParams"}selectionToElement(t,n){return $.createElement(t,n)}addAuto(){this._canvasService.lastElement?.name===this.params.name&&(this.params.name="Shape - "+Math.trunc(1e6*Math.random()));const t=this.selectionToElement(this._selection,this.params);t&&this._canvasService.addElement(t)}setParams(t){Object.assign(this.params,t)}selectImage(t){this.params.src=t}setText(t){this.params.value=t}changeSelection(t=a.RECTANGLE){t!==this._selection&&(this._selection=t,this._selectionChange$.next(this._selection),this._paramsType=this.getParamsType(),this._paramsTypeSubject$.next(this._paramsType))}addShape(){this._canvasService.lastElement?.name===this.params.name&&(this.params.name="Shape - "+Math.trunc(1e6*Math.random())),this._canvasService.addElement(this.selectionToElement(this._selection,this.params)),this._canvasService.render()}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(g))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();function Z(o){return o instanceof x?a.TRIANGLE:o instanceof y?a.ELLIPSE:o instanceof m?a.TEXT:o instanceof E?a.IMAGE:o instanceof f?a.LINE:a.RECTANGLE}let D=(()=>{class o{constructor(t){this._canvasService=t,this._selectedShapes=Array(),this._multiselect=!1,this._wasMoved=!1}get params(){const t=this._selectedShapes.at(this._selectedShapes.length-1);return t?t.params:{x:100,y:100,x2:200,y2:200,strokeStyle:"black",fillStyle:"red",name:"",h:100,w:100,r:0,value:"Hello world!",fontSize:14,src:""}}get paramsType(){return function z(o){return o instanceof m?"textParams":o instanceof E?"imageParams":o instanceof f?"lineParams":"fillParams"}(this._selectedShapes.at(-1)??new M({}))}get selectedShapes(){return[...this._selectedShapes]}useMultiselect(){this._multiselect=!0}disableMultiselect(){this._multiselect=!1}removeSelectedShapes(){for(let t of this._selectedShapes)this._canvasService.removeElem(t.name);this._selectedShapes=[]}static doesCross(t,n,i){let r,_,l,h;return r=t.coords.x,_=t.coords.y,t instanceof f?(l=t.fullCoords.x2,h=t.fullCoords.y2):t instanceof y?(r=t.coords.x-t.width,_=t.coords.y-t.height,l=t.coords.x+t.width,h=t.coords.y+t.height):t instanceof m?([l,h]=[t.coords.x+t.value.length*Math.ceil(t.fontSize/7*3),t.coords.y],_=t.coords.y-t.fontSize):(l=r+t.width,h=_+t.height),r<l&&([r,l]=[l,r]),_<h&&([_,h]=[h,_]),r>n&&l<n&&_>i&&h<i}useParams(t){for(let n of this._selectedShapes)n.setParams(t)}selectShape(){if(this._lastHover){if(!this._multiselect){for(let t of this._selectedShapes)t.deselect();this._selectedShapes=[]}this._lastHover.isSelected?(this._lastHover.deselect(),this._selectedShapes=this._selectedShapes.filter(t=>!T(t,this._lastHover))):this._lastHover.select(),this._selectedShapes.push(this._lastHover),this._canvasService.render()}else if(!this._multiselect){for(let t of this._selectedShapes)t.deselect();this._selectedShapes=[],this._canvasService.render()}}prepareMove(){this._wasMoved=!0;for(let t of this._selectedShapes)this._canvasService.removeElem(t.name)}moveShapes(t,n){for(let i of this._selectedShapes)i.setParams({x:i.coords.x+t,y:i.coords.y+n});this._canvasService.render();for(let i of this._selectedShapes)this._canvasService.renderPreviw(Z(i),i.params)}commitMovement(){if(this._wasMoved){for(let t of this._selectedShapes)this._canvasService.addElement(t);this._wasMoved=!1}}hoverShape(t,n){if(this._lastHover)o.doesCross(this._lastHover,t,n)||(this._lastHover=void 0,this._canvasService.render());else for(let i of[...this._canvasService.elements].reverse())if(o.doesCross(i,t,n))return this._canvasService.render(),i.drawHover(this._canvasService.context),void(this._lastHover=i)}}return o.\u0275fac=function(t){return new(t||o)(e.LFG(g))},o.\u0275prov=e.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();const X=["canvas"];let H=(()=>{class o{constructor(t,n,i,r){this._canvasService=t,this._creationService=n,this._toastrService=i,this._editindService=r,this._$resize=new v.w0,this._$mouseMoveSub=new v.w0,this.mouseX=0,this.mouseY=0}ngAfterViewInit(){this._canvasService.init(this.canvas.nativeElement),this._$dragNDrop=(0,C.R)(this.canvas.nativeElement,"mousemove"),this._$resize=(0,C.R)(window,"resize").subscribe(()=>{this._canvasService.render()})}ngOnDestroy(){this._canvasService.uninit(),this._$resize.unsubscribe()}setParams(){this._creationService.setParams({x:this._startPoint.x,y:this._startPoint.y,x2:this._endPoint.x,y2:this._endPoint.y,h:this._endPoint.y-this._startPoint.y,w:this._endPoint.x-this._startPoint.x,fontSize:Math.abs(this._endPoint.y-this._startPoint.y)})}handleHandMouseDown(){this._editindService.selectShape();let t=!1,n=this._startPoint;this._$mouseMoveSub=this._$dragNDrop.subscribe({next:i=>{if(i.preventDefault(),t||(this._editindService.prepareMove(),t=!0),i instanceof MouseEvent){const[r,_]=[i.offsetX-n.x,i.offsetY-n.y];n={x:i.offsetX,y:i.offsetY},this._editindService.moveShapes(r,_)}}})}onMouseDown(t){t instanceof MouseEvent&&(this._startPoint={x:t.offsetX,y:t.offsetY}),this._creationService.selection===a.HAND?this.handleHandMouseDown():this._$mouseMoveSub=this._$dragNDrop.subscribe({next:n=>{n.preventDefault(),n instanceof MouseEvent&&(this._endPoint={x:n.offsetX,y:n.offsetY},this._canvasService.renderPreviw(this._creationService.selection,this._creationService.params)),this.setParams()}})}onMouseUp(t){if(this._canvasService.lockCanvas)this._canvasService.enableClick();else try{this._creationService.selection===a.HAND?(this._editindService.commitMovement(),this._$mouseMoveSub.unsubscribe()):(t instanceof MouseEvent&&(this._endPoint={x:t.offsetX,y:t.offsetY}),this._$mouseMoveSub.unsubscribe(),T(this._startPoint,this._endPoint)?(this._creationService.params.x=this._startPoint.x,this._creationService.params.y=this._startPoint.y,this._creationService.addAuto()):this._creationService.addShape())}catch(n){n instanceof Error&&this._toastrService.warning(n.message,"\u0412\u0438\u043D\u0438\u043A\u043B\u0430 \u043F\u043E\u043C\u0438\u043B\u043A\u0430!")}}onMouseMove(t){this._creationService.selection===a.HAND&&(t instanceof MouseEvent&&([this.mouseX,this.mouseY]=[t.offsetX,t.offsetY]),this._editindService.hoverShape(this.mouseX,this.mouseY))}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(g),e.Y36(O),e.Y36(d.quB),e.Y36(D))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-canvas"]],viewQuery:function(t,n){if(1&t&&e.Gf(X,5),2&t){let i;e.iGM(i=e.CRH())&&(n.canvas=i.first)}},decls:6,vars:4,consts:[[1,"canvas-area"],["canvasArea",""],[3,"width","height","mousemove","mousedown","mouseup"],["canvas",""]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0,1)(2,"p"),e._uU(3),e.qZA(),e.TgZ(4,"canvas",2,3),e.NdJ("mousemove",function(r){return n.onMouseMove(r)})("mousedown",function(r){return n.onMouseDown(r)})("mouseup",function(r){return n.onMouseUp(r)}),e.qZA()()),2&t){const i=e.MAs(1),r=e.MAs(5);e.xp6(3),e.AsE("X: ",n.mouseX,"; Y: ",n.mouseY,""),e.xp6(1),e.Q6J("width",i.getBoundingClientRect().width)("height",.5*r.clientWidth)}},styles:["canvas[_ngcontent-%COMP%]{border-width:1;border-color:#000;border-style:solid;cursor:grab}.canvas-area[_ngcontent-%COMP%]{width:1000}"]}),o})(),J=(()=>{class o{constructor(t,n){this._creationService=t,this._canvasService=n,this.options=a,this.isInitialized=()=>!1,this.statuses={[a.RECTANGLE]:"basic",[a.ELLIPSE]:"basic",[a.TRIANGLE]:"basic",[a.LINE]:"basic",[a.IMAGE]:"basic",[a.TEXT]:"basic",[a.HAND]:"success"}}onToolSelectClick(t,n){this.statuses[this._creationService.selection]="basic",this._creationService.changeSelection(n),this.statuses[n]="success",this._canvasService.canvas&&(this._canvasService.canvas.style.cursor=this._creationService.selection===a.HAND?"grab":"crosshair")}onClearClick(){this._canvasService.clear()}ngAfterViewInit(){this.isInitialized=()=>this._canvasService.isInitialized}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(O),e.Y36(g))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-toolbar"]],decls:20,vars:15,consts:function(){let s,t,n,i,r,_,l,h;return s=" \u0420\u0423\u041A\u0410 ",t=" \u041F\u0420\u042F\u041C\u041E\u041A\u0423\u0422\u041D\u0418\u041A ",n=" \u0415\u041B\u0406\u041F\u0421 ",i=" \u041B\u0406\u041D\u0406\u042F ",r=" \u0422\u0420\u0418\u041A\u0423\u0422\u041D\u0418\u041A ",_=" \u0422\u0415\u041A\u0421\u0422 ",l=" \u0417\u041E\u0411\u0420\u0410\u0416\u0415\u041D\u041D\u042F ",h=" \u041E\u0427\u0418\u0421\u0422\u0418\u0422\u0418 ",[[1,"toolbar"],["nbButton","","id","rectangle-button",1,"selected",3,"disabled","status","click"],["defaultSelection",""],s,t,["nbButton","","id","elipse-button",3,"disabled","status","click"],n,["nbButton","","id","line-button",3,"disabled","status","click"],i,["nbButton","","id","triangle-button",3,"disabled","status","click"],r,["nbButton","","id","text-button",3,"disabled","status","click"],_,["type","file","id","img-input","accept","image/*",2,"display","none"],["nbButton","","id","image-button",3,"disabled","status","click"],l,["nbButton","","id","clear-button",3,"disabled","click"],h]},template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"button",1,2),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.HAND)}),e.SDv(3,3),e.qZA(),e.TgZ(4,"button",1,2),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.RECTANGLE)}),e.SDv(6,4),e.qZA(),e.TgZ(7,"button",5),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.ELLIPSE)}),e.SDv(8,6),e.qZA(),e.TgZ(9,"button",7),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.LINE)}),e.SDv(10,8),e.qZA(),e.TgZ(11,"button",9),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.TRIANGLE)}),e.SDv(12,10),e.qZA(),e.TgZ(13,"button",11),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.TEXT)}),e.SDv(14,12),e.qZA(),e._UZ(15,"input",13),e.TgZ(16,"button",14),e.NdJ("click",function(r){return n.onToolSelectClick(r,n.options.IMAGE)}),e.SDv(17,15),e.qZA(),e.TgZ(18,"button",16),e.NdJ("click",function(){return n.onClearClick()}),e.SDv(19,17),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.HAND),e.xp6(3),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.RECTANGLE),e.xp6(3),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.ELLIPSE),e.xp6(2),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.LINE),e.xp6(2),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.TRIANGLE),e.xp6(2),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.TEXT),e.xp6(3),e.Q6J("disabled",!n.isInitialized)("status",n.statuses.IMAGE),e.xp6(2),e.Q6J("disabled",!n.isInitialized))},dependencies:[d.DPz],styles:[".toolbar[_ngcontent-%COMP%]{display:flex;flex-direction:column}"]}),o})();var B=u(9646),U=u(1005);function V(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"p")(1,"label",23),e.SDv(2,24),e.qZA(),e.TgZ(3,"input",25),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.params.fillStyle=i)})("change",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onFieldChange(i))}),e.qZA()()}if(2&o){const t=e.oxw(2);e.xp6(3),e.Q6J("ngModel",t.params.fillStyle)}}function F(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"p",26),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.onImgSrcClick())}),e.TgZ(1,"input",27),e.NdJ("change",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onImgSrcChange(i))})("change",function(i){e.CHM(t);const r=e.oxw(2);return e.KtG(r.onFieldChange(i))}),e.qZA()()}}function q(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"p")(2,"label",13),e.SDv(3,14),e.qZA(),e.TgZ(4,"input",15),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.h=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()(),e.TgZ(5,"p")(6,"label",16),e.SDv(7,17),e.qZA(),e.TgZ(8,"input",18),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.w=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()(),e.TgZ(9,"p")(10,"label",19),e.SDv(11,20),e.qZA(),e.TgZ(12,"input",21),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.r=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()(),e.YNc(13,V,4,1,"p",10),e.YNc(14,F,2,0,"p",22),e.qZA()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.params.h),e.xp6(4),e.Q6J("ngModel",t.params.w),e.xp6(4),e.Q6J("ngModel",t.params.r),e.xp6(1),e.Q6J("ngIf","fillParams"===t.paramsType),e.xp6(1),e.Q6J("ngIf","imageParams"===t.paramsType)}}function Q(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"p")(2,"label",28),e._uU(3,"x2: "),e.qZA(),e.TgZ(4,"input",29),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.x2=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()(),e.TgZ(5,"p")(6,"label",30),e._uU(7,"y2: "),e.qZA(),e.TgZ(8,"input",31),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.y2=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.params.x2),e.xp6(4),e.Q6J("ngModel",t.params.y2)}}function Y(o,s){if(1&o){const t=e.EpF();e.TgZ(0,"div")(1,"p")(2,"label",19),e.SDv(3,32),e.qZA(),e.TgZ(4,"input",21),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.r=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()(),e.TgZ(5,"p")(6,"label",33),e.SDv(7,34),e.qZA(),e.TgZ(8,"input",35),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.fontSize=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()(),e.TgZ(9,"p")(10,"label",36),e.SDv(11,37),e.qZA(),e.TgZ(12,"input",38),e.NdJ("ngModelChange",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.params.value=i)})("change",function(i){e.CHM(t);const r=e.oxw();return e.KtG(r.onFieldChange(i))}),e.qZA()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("ngModel",t.params.r),e.xp6(4),e.Q6J("ngModel",t.params.fontSize),e.xp6(4),e.Q6J("ngModel",t.params.value)}}let K=(()=>{class o{constructor(t,n,i){this._creationService=t,this._canvasService=n,this._editionService=i}get params(){return this._creationService.selection===a.HAND?this._editionService.params:this._creationService.params}get paramsType(){return this._creationService.selection==a.HAND?this._editionService.paramsType:this._creationService.getParamsType()}onFieldChange(t){let n=t.target;if(n instanceof HTMLInputElement){const i=this._editionService.params;switch(n.name){case"name":case"strokeStyle":case"fillStyle":case"value":i[n.name]=n.value.toString();break;case"x":case"y":case"h":case"w":case"x2":case"y2":case"r":case"fontSize":i[n.name]=parseInt(n.value)}this._editionService.useParams(i),this._canvasService.render()}}ngOnInit(){this._creationService.selectionChange.subscribe(()=>{})}onImgSrcClick(){this._canvasService.disableClick()}onRemoveClick(){this._editionService.removeSelectedShapes(),this._canvasService.render()}onImgSrcChange(t){if(t.target instanceof HTMLInputElement&&t.target.files&&t.target.files.length>0){this._creationService.selectImage(URL.createObjectURL(t.target.files[0]));const n=new v.w0;n.add((0,B.of)(null).pipe((0,U.g)(300)).subscribe(()=>{this._canvasService.enableClick(),n.unsubscribe()}))}}}return o.\u0275fac=function(t){return new(t||o)(e.Y36(O),e.Y36(g),e.Y36(D))},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-props"]],decls:22,vars:7,consts:function(){let s,t,n,i,r,_,l,h,c,G;return s="\u0406\u043C'\u044F: ",t="\u041A\u043E\u043B\u0456\u0440 \u0441\u0442\u0440\u043E\u043A\u0438: ",n="\u0412\u0438\u0434\u0430\u043B\u0438\u0442\u0438",i="\u0412\u0438\u0441\u043E\u0442\u0430: ",r="\u0428\u0438\u0440\u0438\u043D\u0430: ",_="\u041D\u0430\u0445\u0438\u043B: ",l="\u0417\u0430\u043B\u0438\u0432\u043A\u0430: ",h="\u041D\u0430\u0445\u0438\u043B: ",c="\u0420\u043E\u0437\u043C\u0456\u0440 \u0442\u0435\u043A\u0441\u0442\u0443: ",G="\u0417\u043D\u0430\u0447\u0435\u043D\u043D\u044F: ",[["for","name"],s,["nbInput","","type","text","name","name","id","text-field",3,"ngModel","ngModelChange","change"],["for","x"],["nbInput","","type","number","name","x","id","x-field",3,"ngModel","ngModelChange","change"],["for","y"],["nbInput","","type","number","name","y","id","y-field",3,"ngModel","ngModelChange","change"],["for","strokeStyle"],t,["nbInput","","fieldSize","medium","type","color","name","strokeStyle","id","strokeStyle-field",3,"ngModel","ngModelChange","change"],[4,"ngIf"],["nbButton","","status","danger",3,"click"],n,["for","h"],i,["nbInput","","type","number","name","h","id","h-field",3,"ngModel","ngModelChange","change"],["for","w"],r,["nbInput","","type","number","name","w","id","w-field",3,"ngModel","ngModelChange","change"],["for","r"],_,["nbInput","","type","number","name","r","id","r-field",3,"ngModel","ngModelChange","change"],[3,"click",4,"ngIf"],["for","fillStyle"],l,["nbInput","","fieldSize","medium","type","color","name","fillStyle","id","fillStyle-field",3,"ngModel","ngModelChange","change"],[3,"click"],["nbInput","","type","file","name","imgSrc","id","imgSrc",3,"change"],["for","x2"],["nbInput","","type","number","name","x2","id","x2-field",3,"ngModel","ngModelChange","change"],["for","y2"],["nbInput","","type","number","name","y2","id","y2-field",3,"ngModel","ngModelChange","change"],h,["for","fontSize"],c,["nbInput","","type","number","name","fontSize","id","fontSize-field",3,"ngModel","ngModelChange","change"],["for","value"],G,["nbInput","","type","text","name","value","id","value-field",3,"ngModel","ngModelChange","change"]]},template:function(t,n){1&t&&(e.TgZ(0,"div")(1,"p")(2,"label",0),e.SDv(3,1),e.qZA(),e.TgZ(4,"input",2),e.NdJ("ngModelChange",function(r){return n.params.name=r})("change",function(r){return n.onFieldChange(r)}),e.qZA()(),e.TgZ(5,"p")(6,"label",3),e._uU(7,"x: "),e.qZA(),e.TgZ(8,"input",4),e.NdJ("ngModelChange",function(r){return n.params.x=r})("change",function(r){return n.onFieldChange(r)}),e.qZA()(),e.TgZ(9,"p")(10,"label",5),e._uU(11,"y: "),e.qZA(),e.TgZ(12,"input",6),e.NdJ("ngModelChange",function(r){return n.params.y=r})("change",function(r){return n.onFieldChange(r)}),e.qZA()(),e.TgZ(13,"p")(14,"label",7),e.SDv(15,8),e.qZA(),e.TgZ(16,"input",9),e.NdJ("ngModelChange",function(r){return n.params.strokeStyle=r})("change",function(r){return n.onFieldChange(r)}),e.qZA()()(),e.YNc(17,q,15,5,"div",10),e.YNc(18,Q,9,2,"div",10),e.YNc(19,Y,13,3,"div",10),e.TgZ(20,"button",11),e.NdJ("click",function(){return n.onRemoveClick()}),e.SDv(21,12),e.qZA()),2&t&&(e.xp6(4),e.Q6J("ngModel",n.params.name),e.xp6(4),e.Q6J("ngModel",n.params.x),e.xp6(4),e.Q6J("ngModel",n.params.y),e.xp6(4),e.Q6J("ngModel",n.params.strokeStyle),e.xp6(1),e.Q6J("ngIf","fillParams"===n.paramsType||"imageParams"===n.paramsType),e.xp6(1),e.Q6J("ngIf","lineParams"===n.paramsType),e.xp6(1),e.Q6J("ngIf","textParams"===n.paramsType))},dependencies:[R.O5,S.Fj,S.wV,S.JJ,S.On,d.DPz,d.h8i]}),o})();const j=[{path:"",component:(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275cmp=e.Xpm({type:o,selectors:[["app-main-component"]],decls:4,vars:0,consts:[[1,"canvas-page"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e._UZ(1,"app-toolbar")(2,"app-canvas")(3,"app-props"),e.qZA())},dependencies:[H,J,K],styles:[".canvas-page[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between}app-canvas[_ngcontent-%COMP%]{width:60%}"]}),o})()}];let W=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[w.Bz.forChild(j),w.Bz]}),o})(),ee=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.oAB({type:o}),o.\u0275inj=e.cJS({imports:[R.ez,W,S.u5,d.T2N,d.nKr,d.BW0,d.P1,d.LW9]}),o})()}}]);